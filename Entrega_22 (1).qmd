
title: "Ejercicios de Estadística descriptiva multivariante" format: 
  html: 
    theme: lumen  
    toc: true
```{r, echo=FALSE, message=FALSE, warning=FALSE}
library(GGally) 
library(tidyverse) 
```  
## Ejercicio   Una empresa quiere analizar si existe relación entre las ventas de sus productos, la inversión en publicidad y la satisfacción del cliente. Los datos que corresponden a las ventas en miles de unidades, el gasto en publicidad en miles de euros y la puntuación de satisfacción del cliente en una escala de 1 a 10 para 15 productos, los puedes descargar en el siguiente enlace: [datos empresa](https://github.com/igmuib/Practica_AD/blob/main/datos_empresa.csv)
Leemos los datos 

```{r, message=FALSE, warning=FALSE} 
#ruta<- "C:\Users\rbnlp\Downloads\datos_empresa.csv" 
#datos_empresa <- read.csv(ruta)
#datos empresa mirado desde import dataset con readr
library(readr)
datos_empresa <- read_csv("C:/Users/rbnlp/Downloads/datos_empresa.csv")
library(GGally)
library(tidyverse) 
glimpse(datos_empresa)
```  
### Apartado b 
Calcula, por un lado con formulación matricial y, por otro, mediante instrucciones en R/tidyverse la matriz de correlaciones. Presenta una visualización de ella con la librería `GGally`y la función `ggpairs()`.  Interpreta el resultado en el contexto del problema. 
### Respuesta 
```{r, message=FALSE,warning=FALSE}
library(GGally)
#n=30
v1=datos_empresa$Producto
v2=datos_empresa$Ventas
v3=datos_empresa$Publicidad
v4=datos_empresa$Satisfaccion_cliente
A=matrix(c(v1,v2,v3,v4),ncol=4) #matriz de datos
cor(A) #matriz de correlaciones
J=matrix(rep(1,30*30),nrow=30)
H=diag(30)-(1/30)*J
S=(1/30)*t(A)%*%H%*%A #matriz de covarianzas
#tambien sería válido usar cov(X)*30/29

sd1=sqrt(sum((v1 - mean(v1))^2) / 30)
sd2=sqrt(sum((v2 - mean(v2))^2) / 30)
sd3=sqrt(sum((v3 - mean(v3))^2) / 30)
sd4=sqrt(sum((v4 - mean(v4))^2) / 30)
D=diag(c(sd1,sd2,sd3,sd4))
R=solve(D)%*%S%*%solve(D)
R
ggpairs(datos_empresa)
```
Las ventas están relacionadas con la publicidad y la satisfacción del cliente, y estás 2 últimas variables también están relacionadas entre sí. Notemos que esta relación es prácticamente lineal y con pendiente positiva, ya que los coeficientes de correlación son prácticamente 1.
Por otro lado, la variable producto no está relacionada con ninguna de las otras variables, lo cual tiene sentido (se podría no considerar en el análisis.)
Vemos además, que la marca B es la que más se ha publicitado ,la que más se ha vendido y la que más satisfacción entre los clientes ha dejado.
```{r}
library(corrplot)
corrplot(cor(A))
```
```
